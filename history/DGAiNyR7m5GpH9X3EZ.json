[{
  "history_id" : "n6gawnwlgjz",
  "history_input" : "# importing necessary libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nfrom pathlib import Path\nimport geopandas as gpd\nimport cmaps\nfrom datetime import datetime\n\nimport imageio\nimport glob\nimport os\n\n\nmpl.rcParams['font.size'] = 25\n\n# home directory\nhome = str(Path.home())\n\n# Delete previous .tif images only (not folder) to reduce space if folder and files exist already.\nif Path(home + \"/cmaq/prediction_maps/\"):\n    for file in Path(home + \"/cmaq/prediction_maps/\").glob(\"*\"):\n        if file.is_file():\n          [f.unlink() for f in Path(home + \"/cmaq/prediction_maps/\").glob(\"*\") if f.is_file()] \n\n# importing data\ndf = pd.read_csv('/groups/ESS/aalnaim/cmaq/prediction_files/prediction_rf.csv')\nAirnowObs = pd.read_csv(home + \"/cmaq/observation.csv\")\nAirnowObs = AirnowObs.loc[AirnowObs['AirNOW_O3'] != -999]\n\ntime_ = df['YYYYMMDDHH'].unique()\ndfs = dict(tuple(df.groupby('YYYYMMDDHH')))  # grouping the data by YYMMDDHH\n\ntime_Airnow = AirnowObs['YYYYMMDDHH'].unique()\ndfs_Airnow = dict(tuple(AirnowObs.groupby('YYYYMMDDHH')))  # grouping the data by YYMMDDHH\n\ncmap = cmaps.WhiteBlueGreenYellowRed[0:262:12]\n\n\n\n\nfiles=glob.glob(\"/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_*.tif\")\n#files = sorted(files)\nfiles = sorted(files)\nimages=[]\n\nfor i in files:\n    print(i)\n    img=imageio.imread(i)\n    images.append(img)\n    \nimageio.mimsave('/groups/ESS/aalnaim/cmaq/prediction.mp4', images, fps=10)\n\n\nfiles=glob.glob(\"/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_*.tif\")\n#files = sorted(files)\nfiles = sorted(files)\nimages=[]\n\nfor i in files:\n    print(i)\n    img=imageio.imread(i)\n    images.append(img)\n    \nimageio.mimsave(\"/groups/ESS/aalnaim/cmaq/predctionAirNow.mp4\", images, fps=10)\n\n# create .gif from .mp4 using FFmpeg\nos.system('ffmpeg -i /groups/ESS/aalnaim/cmaq/prediction.mp4 -vf \"scale=2000:-1:flags=lanczos,split[s0][s1];[s0]palettegen[p];[s1][p]paletteuse, fps=10\" /groups/ESS/aalnaim/cmaq/prediction.gif')\n\n# remove the created .mp4 file\nos.system('rm /groups/ESS/aalnaim/cmaq/prediction.mp4')\n\n\n# create .gif from .mp4 using FFmpeg\nos.system('ffmpeg -i /groups/ESS/aalnaim/cmaq/predctionAirNow.mp4 -vf \"scale=2000:-1:flags=lanczos,split[s0][s1];[s0]palettegen[p];[s1][p]paletteuse, fps=10\" /groups/ESS/aalnaim/cmaq/predctionAirNow.gif')\n\n# remove the created .mp4 file\nos.system('rm /groups/ESS/aalnaim/cmaq/predctionAirNow.mp4')\n",
  "history_output" : "/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052600.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052601.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052602.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052603.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052604.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052605.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052606.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052607.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052608.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052609.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052610.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052611.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052612.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052613.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052614.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052615.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052616.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052617.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052618.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052619.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052620.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052621.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052622.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052623.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052700.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052701.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052702.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052703.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052704.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052705.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052706.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052707.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052708.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052709.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052710.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052711.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052712.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052713.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052714.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052715.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052716.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052717.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052718.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052719.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052720.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052721.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052722.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/CMAQ_2022052723.tif\nIMAGEIO FFMPEG_WRITER WARNING: input image is not divisible by macro_block_size=16, resizing from (2000, 1800) to (2000, 1808) to ensure video compatibility with most codecs and players. To prevent resizing, make your input image divisible by the macro_block_size or set the macro_block_size to 1 (risking incompatibility).\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052700.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052701.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052702.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052703.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052704.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052705.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052706.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052707.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052708.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052709.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052710.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052711.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052712.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052713.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052714.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052715.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052716.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052717.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052718.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052719.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052720.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052721.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052722.tif\n/groups/ESS/aalnaim/cmaq/prediction_maps/AirNow_2022052723.tif\nIMAGEIO FFMPEG_WRITER WARNING: input image is not divisible by macro_block_size=16, resizing from (2000, 1800) to (2000, 1808) to ensure video compatibility with most codecs and players. To prevent resizing, make your input image divisible by the macro_block_size or set the macro_block_size to 1 (risking incompatibility).\nsh: ffmpeg: command not found\nsh: ffmpeg: command not found\n",
  "history_begin_time" : 1654542716355,
  "history_end_time" : 1654542762828,
  "history_notes" : null,
  "history_process" : "6oifw4",
  "host_id" : "p6wvf2",
  "indicator" : "Done"
},{
  "history_id" : "9eib9x5vep4",
  "history_input" : "#!/bin/bash\nmodule load ffmpeg",
  "history_output" : "Running",
  "history_begin_time" : 1654542710848,
  "history_end_time" : 1654542714378,
  "history_notes" : null,
  "history_process" : "ah91af",
  "host_id" : "p6wvf2",
  "indicator" : "Done"
}]
